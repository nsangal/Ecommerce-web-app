<div class="container mt-5">
  <h2>Sign Up</h2>
  <form [formGroup]="signUpForm" (ngSubmit)="onSubmit()">
    <div class="row mb-3">
      <label for="email" class="col-sm-2 col-form-label">Email</label>
      <div class="col-sm-10">
        <input id="email" type="email" class="form-control" formControlName="email" (input)="clearError('email')">
        <div *ngIf="submitted && firstInvalidField === 'email' && signUpForm.get('email')?.invalid" class="text-danger">
          <div *ngIf="signUpForm.get('email')?.errors?.required">Email is required.</div>
          <div *ngIf="signUpForm.get('email')?.errors?.email">Please enter a valid email.</div>
        </div>
      </div>
    </div>
    <div class="row mb-3">
      <label for="firstName" class="col-sm-2 col-form-label">First Name</label>
      <div class="col-sm-10">
        <input id="firstName" type="text" class="form-control" formControlName="firstName" (input)="clearError('firstName')">
        <div *ngIf="submitted && firstInvalidField === 'firstName' && signUpForm.get('firstName')?.invalid" class="text-danger">
          <div *ngIf="signUpForm.get('firstName')?.errors?.required">First name is required.</div>
        </div>
      </div>
    </div>
    <div class="row mb-3">
      <label for="lastName" class="col-sm-2 col-form-label">Last Name</label>
      <div class="col-sm-10">
        <input id="lastName" type="text" class="form-control" formControlName="lastName" (input)="clearError('lastName')">
        <div *ngIf="submitted && firstInvalidField === 'lastName' && signUpForm.get('lastName')?.invalid" class="text-danger">
          <div *ngIf="signUpForm.get('lastName')?.errors?.required">Last name is required.</div>
        </div>
      </div>
    </div>
    <div class="row mb-3">
      <label for="password" class="col-sm-2 col-form-label">Password</label>
      <div class="col-sm-10">
        <input id="password" type="password" class="form-control" formControlName="password" (input)="clearError('password')">
        <div *ngIf="submitted && firstInvalidField === 'password' && signUpForm.get('password')?.invalid" class="text-danger">
          <div *ngIf="signUpForm.get('password')?.errors?.required">Password is required.</div>
          <div *ngIf="signUpForm.get('password')?.errors?.minlength">Password must be at least 8 characters long.</div>
          <div *ngIf="signUpForm.get('password')?.errors?.pattern">Password must contain at least one letter, one number, and one special character.</div>
        </div>
      </div>
    </div>
    <div class="row mb-3">
      <label for="username" class="col-sm-2 col-form-label">Username</label>
      <div class="col-sm-10">
        <input id="username" type="text" class="form-control" formControlName="username" (input)="clearError('username')">
        <div *ngIf="submitted && firstInvalidField === 'username'" class="text-danger">
          <div *ngIf="usernameTaken">Username is already taken.</div>
          <div *ngIf="signUpForm.get('username')?.invalid && !usernameTaken">
            <div *ngIf="signUpForm.get('username')?.errors?.required">Username is required.</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-sm-10 offset-sm-2">
        <button type="submit" class="btn btn-primary">Sign Up</button>
      </div>
    </div>
  </form>
</div>
